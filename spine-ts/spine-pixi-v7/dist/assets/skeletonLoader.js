/******************************************************************************
 * Spine Runtimes License Agreement
 * Last updated April 5, 2025. Replaces all prior versions.
 *
 * Copyright (c) 2013-2025, Esoteric Software LLC
 *
 * Integration of the Spine Runtimes into software or otherwise creating
 * derivative works of the Spine Runtimes is permitted under the terms and
 * conditions of Section 2 of the Spine Editor License Agreement:
 * http://esotericsoftware.com/spine-editor-license
 *
 * Otherwise, it is permitted to integrate the Spine Runtimes into software
 * or otherwise create derivative works of the Spine Runtimes (collectively,
 * "Products"), provided that each user of the Products must obtain their own
 * Spine Editor license and redistribution of the Products in any form must
 * include this license and copyright notice.
 *
 * THE SPINE RUNTIMES ARE PROVIDED BY ESOTERIC SOFTWARE LLC "AS IS" AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL ESOTERIC SOFTWARE LLC BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES,
 * BUSINESS INTERRUPTION, OR LOSS OF USE, DATA, OR PROFITS) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THE SPINE RUNTIMES, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *****************************************************************************/
import { LoaderParserPriority, checkExtension } from "@pixi/assets";
import { ExtensionType, settings, extensions } from "@pixi/core";
const loaderName = "spineSkeletonLoader";
function isJson(resource) {
    return resource.hasOwnProperty("bones");
}
function isBuffer(resource) {
    return resource instanceof Uint8Array;
}
const spineLoaderExtension = {
    extension: ExtensionType.Asset,
    loader: {
        name: loaderName,
        extension: {
            type: ExtensionType.LoadParser,
            priority: LoaderParserPriority.Normal,
            name: loaderName,
        },
        test(url) {
            return checkExtension(url, ".skel");
        },
        async load(url) {
            const response = await settings.ADAPTER.fetch(url);
            const buffer = new Uint8Array(await response.arrayBuffer());
            return buffer;
        },
        testParse(asset, options) {
            const isJsonSpineModel = checkExtension(options.src, ".json") && isJson(asset);
            const isBinarySpineModel = checkExtension(options.src, ".skel") && isBuffer(asset);
            const isExplicitLoadParserSet = options.loadParser === loaderName;
            return Promise.resolve(isJsonSpineModel || isBinarySpineModel || isExplicitLoadParserSet);
        },
    },
};
extensions.add(spineLoaderExtension);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tlbGV0b25Mb2FkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYXNzZXRzL3NrZWxldG9uTG9hZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7K0VBMkIrRTtBQUcvRSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsY0FBYyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ3BFLE9BQU8sRUFBRSxhQUFhLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUtqRSxNQUFNLFVBQVUsR0FBRyxxQkFBcUIsQ0FBQztBQUV6QyxTQUFTLE1BQU0sQ0FBQyxRQUFhO0lBQzVCLE9BQU8sUUFBUSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN6QyxDQUFDO0FBRUQsU0FBUyxRQUFRLENBQUMsUUFBYTtJQUM5QixPQUFPLFFBQVEsWUFBWSxVQUFVLENBQUM7QUFDdkMsQ0FBQztBQUVELE1BQU0sb0JBQW9CLEdBQTREO0lBQ3JGLFNBQVMsRUFBRSxhQUFhLENBQUMsS0FBSztJQUU5QixNQUFNLEVBQUU7UUFDUCxJQUFJLEVBQUUsVUFBVTtRQUNoQixTQUFTLEVBQUU7WUFDVixJQUFJLEVBQUUsYUFBYSxDQUFDLFVBQVU7WUFDOUIsUUFBUSxFQUFFLG9CQUFvQixDQUFDLE1BQU07WUFDckMsSUFBSSxFQUFFLFVBQVU7U0FDaEI7UUFFRCxJQUFJLENBQUMsR0FBRztZQUNQLE9BQU8sY0FBYyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNyQyxDQUFDO1FBRUQsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFXO1lBQ3JCLE1BQU0sUUFBUSxHQUFHLE1BQU0sUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7WUFFbkQsTUFBTSxNQUFNLEdBQUcsSUFBSSxVQUFVLENBQUMsTUFBTSxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUU1RCxPQUFPLE1BQU0sQ0FBQztRQUNmLENBQUM7UUFDRCxTQUFTLENBQUMsS0FBYyxFQUFFLE9BQXNCO1lBQy9DLE1BQU0sZ0JBQWdCLEdBQUcsY0FBYyxDQUFDLE9BQU8sQ0FBQyxHQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hGLE1BQU0sa0JBQWtCLEdBQUcsY0FBYyxDQUFDLE9BQU8sQ0FBQyxHQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BGLE1BQU0sdUJBQXVCLEdBQUcsT0FBTyxDQUFDLFVBQVUsS0FBSyxVQUFVLENBQUM7WUFFbEUsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUFnQixJQUFJLGtCQUFrQixJQUFJLHVCQUF1QixDQUFDLENBQUM7UUFDM0YsQ0FBQztLQUNEO0NBQzBELENBQUM7QUFFN0QsVUFBVSxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogU3BpbmUgUnVudGltZXMgTGljZW5zZSBBZ3JlZW1lbnRcbiAqIExhc3QgdXBkYXRlZCBBcHJpbCA1LCAyMDI1LiBSZXBsYWNlcyBhbGwgcHJpb3IgdmVyc2lvbnMuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLTIwMjUsIEVzb3RlcmljIFNvZnR3YXJlIExMQ1xuICpcbiAqIEludGVncmF0aW9uIG9mIHRoZSBTcGluZSBSdW50aW1lcyBpbnRvIHNvZnR3YXJlIG9yIG90aGVyd2lzZSBjcmVhdGluZ1xuICogZGVyaXZhdGl2ZSB3b3JrcyBvZiB0aGUgU3BpbmUgUnVudGltZXMgaXMgcGVybWl0dGVkIHVuZGVyIHRoZSB0ZXJtcyBhbmRcbiAqIGNvbmRpdGlvbnMgb2YgU2VjdGlvbiAyIG9mIHRoZSBTcGluZSBFZGl0b3IgTGljZW5zZSBBZ3JlZW1lbnQ6XG4gKiBodHRwOi8vZXNvdGVyaWNzb2Z0d2FyZS5jb20vc3BpbmUtZWRpdG9yLWxpY2Vuc2VcbiAqXG4gKiBPdGhlcndpc2UsIGl0IGlzIHBlcm1pdHRlZCB0byBpbnRlZ3JhdGUgdGhlIFNwaW5lIFJ1bnRpbWVzIGludG8gc29mdHdhcmVcbiAqIG9yIG90aGVyd2lzZSBjcmVhdGUgZGVyaXZhdGl2ZSB3b3JrcyBvZiB0aGUgU3BpbmUgUnVudGltZXMgKGNvbGxlY3RpdmVseSxcbiAqIFwiUHJvZHVjdHNcIiksIHByb3ZpZGVkIHRoYXQgZWFjaCB1c2VyIG9mIHRoZSBQcm9kdWN0cyBtdXN0IG9idGFpbiB0aGVpciBvd25cbiAqIFNwaW5lIEVkaXRvciBsaWNlbnNlIGFuZCByZWRpc3RyaWJ1dGlvbiBvZiB0aGUgUHJvZHVjdHMgaW4gYW55IGZvcm0gbXVzdFxuICogaW5jbHVkZSB0aGlzIGxpY2Vuc2UgYW5kIGNvcHlyaWdodCBub3RpY2UuXG4gKlxuICogVEhFIFNQSU5FIFJVTlRJTUVTIEFSRSBQUk9WSURFRCBCWSBFU09URVJJQyBTT0ZUV0FSRSBMTEMgXCJBUyBJU1wiIEFORCBBTllcbiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRURcbiAqIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkVcbiAqIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIEVTT1RFUklDIFNPRlRXQVJFIExMQyBCRSBMSUFCTEUgRk9SIEFOWVxuICogRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVNcbiAqIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUyxcbiAqIEJVU0lORVNTIElOVEVSUlVQVElPTiwgT1IgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFMpIEhPV0VWRVIgQ0FVU0VEIEFORFxuICogT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlRcbiAqIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRlxuICogVEhFIFNQSU5FIFJVTlRJTUVTLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG5pbXBvcnQgdHlwZSB7IEFzc2V0RXh0ZW5zaW9uLCBSZXNvbHZlZEFzc2V0IH0gZnJvbSBcIkBwaXhpL2Fzc2V0c1wiO1xuaW1wb3J0IHsgTG9hZGVyUGFyc2VyUHJpb3JpdHksIGNoZWNrRXh0ZW5zaW9uIH0gZnJvbSBcIkBwaXhpL2Fzc2V0c1wiO1xuaW1wb3J0IHsgRXh0ZW5zaW9uVHlwZSwgc2V0dGluZ3MsIGV4dGVuc2lvbnMgfSBmcm9tIFwiQHBpeGkvY29yZVwiO1xuXG50eXBlIFNrZWxldG9uSnNvbkFzc2V0ID0gYW55O1xudHlwZSBTa2VsZXRvbkJpbmFyeUFzc2V0ID0gVWludDhBcnJheTtcblxuY29uc3QgbG9hZGVyTmFtZSA9IFwic3BpbmVTa2VsZXRvbkxvYWRlclwiO1xuXG5mdW5jdGlvbiBpc0pzb24ocmVzb3VyY2U6IGFueSk6IHJlc291cmNlIGlzIFNrZWxldG9uSnNvbkFzc2V0IHtcblx0cmV0dXJuIHJlc291cmNlLmhhc093blByb3BlcnR5KFwiYm9uZXNcIik7XG59XG5cbmZ1bmN0aW9uIGlzQnVmZmVyKHJlc291cmNlOiBhbnkpOiByZXNvdXJjZSBpcyBTa2VsZXRvbkJpbmFyeUFzc2V0IHtcblx0cmV0dXJuIHJlc291cmNlIGluc3RhbmNlb2YgVWludDhBcnJheTtcbn1cblxuY29uc3Qgc3BpbmVMb2FkZXJFeHRlbnNpb246IEFzc2V0RXh0ZW5zaW9uPFNrZWxldG9uSnNvbkFzc2V0IHwgU2tlbGV0b25CaW5hcnlBc3NldD4gPSB7XG5cdGV4dGVuc2lvbjogRXh0ZW5zaW9uVHlwZS5Bc3NldCxcblxuXHRsb2FkZXI6IHtcblx0XHRuYW1lOiBsb2FkZXJOYW1lLFxuXHRcdGV4dGVuc2lvbjoge1xuXHRcdFx0dHlwZTogRXh0ZW5zaW9uVHlwZS5Mb2FkUGFyc2VyLFxuXHRcdFx0cHJpb3JpdHk6IExvYWRlclBhcnNlclByaW9yaXR5Lk5vcm1hbCxcblx0XHRcdG5hbWU6IGxvYWRlck5hbWUsXG5cdFx0fSxcblxuXHRcdHRlc3QodXJsKSB7XG5cdFx0XHRyZXR1cm4gY2hlY2tFeHRlbnNpb24odXJsLCBcIi5za2VsXCIpO1xuXHRcdH0sXG5cblx0XHRhc3luYyBsb2FkKHVybDogc3RyaW5nKTogUHJvbWlzZTxTa2VsZXRvbkJpbmFyeUFzc2V0PiB7XG5cdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHNldHRpbmdzLkFEQVBURVIuZmV0Y2godXJsKTtcblxuXHRcdFx0Y29uc3QgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKSk7XG5cblx0XHRcdHJldHVybiBidWZmZXI7XG5cdFx0fSxcblx0XHR0ZXN0UGFyc2UoYXNzZXQ6IHVua25vd24sIG9wdGlvbnM6IFJlc29sdmVkQXNzZXQpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRcdGNvbnN0IGlzSnNvblNwaW5lTW9kZWwgPSBjaGVja0V4dGVuc2lvbihvcHRpb25zLnNyYyEsIFwiLmpzb25cIikgJiYgaXNKc29uKGFzc2V0KTtcblx0XHRcdGNvbnN0IGlzQmluYXJ5U3BpbmVNb2RlbCA9IGNoZWNrRXh0ZW5zaW9uKG9wdGlvbnMuc3JjISwgXCIuc2tlbFwiKSAmJiBpc0J1ZmZlcihhc3NldCk7XG5cdFx0XHRjb25zdCBpc0V4cGxpY2l0TG9hZFBhcnNlclNldCA9IG9wdGlvbnMubG9hZFBhcnNlciA9PT0gbG9hZGVyTmFtZTtcblxuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShpc0pzb25TcGluZU1vZGVsIHx8IGlzQmluYXJ5U3BpbmVNb2RlbCB8fCBpc0V4cGxpY2l0TG9hZFBhcnNlclNldCk7XG5cdFx0fSxcblx0fSxcbn0gYXMgQXNzZXRFeHRlbnNpb248U2tlbGV0b25Kc29uQXNzZXQgfCBTa2VsZXRvbkJpbmFyeUFzc2V0PjtcblxuZXh0ZW5zaW9ucy5hZGQoc3BpbmVMb2FkZXJFeHRlbnNpb24pO1xuIl19